---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
```{r, echo=FALSE}
if (!require(ggplot2)) {
      install.packages("ggplot2")
}

if (!require(scales)) {
      install.packages("scales")
}

```

## Loading and preprocessing the data

```{r, cache=TRUE}
steps <- read.csv("./activity.csv")

summary(steps)
```

## What is mean total number of steps taken per day?
```{r, echo=FALSE}
mean_steps<-aggregate(steps$steps,by=list(steps$date),sum )
```
Here is mean of the total number of steps taken per day
```{r, echo=FALSE}
mean(mean_steps$x,na.rm = TRUE)
```
Here is median of the total number of steps taken per day
```{r, echo=FALSE}
median(mean_steps$x,na.rm = TRUE)
```

## What is the average daily activity pattern?
```{r, echo=FALSE}
mean_steps_intvl<-aggregate(steps$steps,by=list(interval=steps$interval),mean, na.rm=TRUE )
gr<-qplot(mean_steps_intvl[,1],mean_steps_intvl$x,geom="line",
          ylab = "Steps By Day Interval", xlab="") 
gr<-gr + scale_x_continuous(breaks = seq(0,2400,100)) + theme_classic()
print(gr)
```


## Imputing missing values
Number of rows with NA's
```{r, echo=FALSE}
nrow(steps[is.na(steps$step), ])
```

```{r, echo=FALSE}
steps2<-steps

steps2[is.na(steps2$step), 1]<-merge(steps2[is.na(steps2$step), ], mean_steps_intvl, by="interval")$x
sum_steps<-aggregate(steps2$steps,by=list(date=steps2$date),sum )

barplot(sum_steps$x, names.arg = sum_steps$date, xlab = "date", ylab = "steps")
```
Here is mean of the total number of steps taken per day for new dataset
```{r, echo=FALSE}
mean(sum_steps$x,na.rm = TRUE)
```
Here is median of the total number of steps taken per day for new dataset
```{r, echo=FALSE}
median(sum_steps$x,na.rm = TRUE)
```

## Are there differences in activity patterns between weekdays and weekends?


